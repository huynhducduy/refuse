function e(){return e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e.apply(this,arguments)}const t=(e,n,r,i)=>{let o;n[0]=0;for(let s=1;s<n.length;s++){const f=n[s++],l=n[s]?(n[0]|=f?1:2,r[n[s++]]):n[++s];3===f?i[0]=l:4===f?i[1]=Object.assign(i[1]||{},l):5===f?(i[1]=i[1]||{})[n[++s]]=l:6===f?i[1][n[++s]]+=l+"":f?(o=e.apply(l,t(e,l,r,["",null])),i.push(o),l[0]?n[0]|=2:(n[s-2]=0,n[s]=o)):i.push(l)}return i},n=function(e){let t,n,r=1,i="",o="",s=[0];const f=e=>{1===r&&(e||(i=i.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?s.push(0,e,i):3===r&&(e||i)?(s.push(3,e,i),r=2):2===r&&"..."===i&&e?s.push(4,e,0):2===r&&i&&!e?s.push(5,0,!0,i):r>=5&&((i||!e&&5===r)&&(s.push(r,0,i,n),r=6),e&&(s.push(r,e,0,n),r=6)),i=""};for(let l=0;l<e.length;l++){l&&(1===r&&f(),f(l));for(let a=0;a<e[l].length;a++)t=e[l][a],1===r?"<"===t?(f(),s=[s],r=3):i+=t:4===r?"--"===i&&">"===t?(r=1,i=""):i=t+i[0]:o?t===o?o="":i+=t:'"'===t||"'"===t?o=t:">"===t?(f(),r=1):r&&("="===t?(r=5,n=i,i=""):"/"===t&&(r<5||">"===e[l][a+1])?(f(),3===r&&(s=s[0]),r=s,(s=s[0]).push(2,0,r),r=0):" "===t||"\t"===t||"\n"===t||"\r"===t?(f(),r=2):i+=t),3===r&&"!--"===i&&(r=4,s=s[0])}return f(),s},r=new Map;function i(e){return e instanceof Buffer?Buffer.from(e):new e.constructor(e.buffer.slice(),e.byteOffset,e.length)}var o=function(e){return(e=e||{}).circles?function(e){var t=[],n=[];return e.proto?function e(o){if("object"!=typeof o||null===o)return o;if(o instanceof Date)return new Date(o);if(Array.isArray(o))return r(o,e);if(o instanceof Map)return new Map(r(Array.from(o),e));if(o instanceof Set)return new Set(r(Array.from(o),e));var s={};for(var f in t.push(o),n.push(s),o){var l=o[f];if("object"!=typeof l||null===l)s[f]=l;else if(l instanceof Date)s[f]=new Date(l);else if(l instanceof Map)s[f]=new Map(r(Array.from(l),e));else if(l instanceof Set)s[f]=new Set(r(Array.from(l),e));else if(ArrayBuffer.isView(l))s[f]=i(l);else{var a=t.indexOf(l);s[f]=-1!==a?n[a]:e(l)}}return t.pop(),n.pop(),s}:function e(o){if("object"!=typeof o||null===o)return o;if(o instanceof Date)return new Date(o);if(Array.isArray(o))return r(o,e);if(o instanceof Map)return new Map(r(Array.from(o),e));if(o instanceof Set)return new Set(r(Array.from(o),e));var s={};for(var f in t.push(o),n.push(s),o)if(!1!==Object.hasOwnProperty.call(o,f)){var l=o[f];if("object"!=typeof l||null===l)s[f]=l;else if(l instanceof Date)s[f]=new Date(l);else if(l instanceof Map)s[f]=new Map(r(Array.from(l),e));else if(l instanceof Set)s[f]=new Set(r(Array.from(l),e));else if(ArrayBuffer.isView(l))s[f]=i(l);else{var a=t.indexOf(l);s[f]=-1!==a?n[a]:e(l)}}return t.pop(),n.pop(),s};function r(e,r){for(var o=Object.keys(e),s=new Array(o.length),f=0;f<o.length;f++){var l=o[f],a=e[l];if("object"!=typeof a||null===a)s[l]=a;else if(a instanceof Date)s[l]=new Date(a);else if(ArrayBuffer.isView(a))s[l]=i(a);else{var c=t.indexOf(a);s[l]=-1!==c?n[c]:r(a)}}return s}}(e):e.proto?function e(n){if("object"!=typeof n||null===n)return n;if(n instanceof Date)return new Date(n);if(Array.isArray(n))return t(n,e);if(n instanceof Map)return new Map(t(Array.from(n),e));if(n instanceof Set)return new Set(t(Array.from(n),e));var r={};for(var o in n){var s=n[o];r[o]="object"!=typeof s||null===s?s:s instanceof Date?new Date(s):s instanceof Map?new Map(t(Array.from(s),e)):s instanceof Set?new Set(t(Array.from(s),e)):ArrayBuffer.isView(s)?i(s):e(s)}return r}:function e(n){if("object"!=typeof n||null===n)return n;if(n instanceof Date)return new Date(n);if(Array.isArray(n))return t(n,e);if(n instanceof Map)return new Map(t(Array.from(n),e));if(n instanceof Set)return new Set(t(Array.from(n),e));var r={};for(var o in n)if(!1!==Object.hasOwnProperty.call(n,o)){var s=n[o];r[o]="object"!=typeof s||null===s?s:s instanceof Date?new Date(s):s instanceof Map?new Map(t(Array.from(s),e)):s instanceof Set?new Set(t(Array.from(s),e)):ArrayBuffer.isView(s)?i(s):e(s)}return r};function t(e,t){for(var n=Object.keys(e),r=new Array(n.length),o=0;o<n.length;o++){var s=n[o],f=e[s];r[s]="object"!=typeof f||null===f?f:f instanceof Date?new Date(f):ArrayBuffer.isView(f)?i(f):t(f)}return r}}();function s(e){return"object"==typeof e&&null!==e&&"type"in e&&"function"==typeof e.type}let f,l,a,c;Element.prototype._addEventListener=Element.prototype.addEventListener,Element.prototype._removeEventListener=Element.prototype.removeEventListener,Element.prototype.addEventListener=function(e,t,n=!1){this._addEventListener(e,t,n),this.eventListenerList||(this.eventListenerList={}),this.eventListenerList[e]||(this.eventListenerList[e]=[]),this.eventListenerList[e].push({type:e,listener:t,useCapture:n})},Element.prototype.removeEventListener=function(e,t,n=!1){this._removeEventListener(e,t,n),this.eventListenerList||(this.eventListenerList={}),this.eventListenerList[e]||(this.eventListenerList[e]=[]);for(let r=0;r<this.eventListenerList[e].length;r++)if(this.eventListenerList[e][r].listener===t&&this.eventListenerList[e][r].useCapture===n){this.eventListenerList[e].splice(r,1);break}0==this.eventListenerList[e].length&&delete this.eventListenerList[e]},Element.prototype.getEventListeners=function(e){return this.eventListenerList||(this.eventListenerList={}),void 0===e?this.eventListenerList:this.eventListenerList[e]};let u=[],p=[],y={value:void 0},d=console.log;d=(...e)=>{};const h=d;function v({children:e}){return e}function m(e,t,n,r){return{ref:r,type:e,props:null!=t?t:{},child:null!=n?n:[],isProcessed:!1,isDirty:!0,state:[],stateIndex:0,effects:[],effectIndex:0,memos:[],memoIndex:0,renderType:void 0,renderProps:{}}}function g(...e){throw new Error(...e)}const L=function(e){let i=r.get(this);return i||(i=new Map,r.set(this,i)),i=t(this,i.get(e)||(i.set(e,i=n(e)),i),arguments,[]),i.length>1?i:i[0]}.bind(function(e,t,...n){var r,i;const o=null==(r=t)?void 0:r.ref;if(null==(i=t)||delete i.ref,"function"==typeof e)return m(e,t,n,o);var s;"string"!=typeof e&&g("Invalid element type, required string, received "+typeof e+" instead: "+JSON.stringify(e)+"."),t||(t={}),Object.getOwnPropertySymbols(t).length>0&&g("Invalid element prop name in "+e+", we don't support for symbol prop name, please try another primitive.");for(const n of Object.values(t))"string"!=typeof n&&"number"!=typeof n&&"function"!=typeof n&&g("Invalid element prop value in "+e+", we only support for string, number and function prop value.");return{ref:o,renderType:e,renderProps:null!=(s=t)?s:{},child:n}});function b(e){"number"!=typeof e&&"string"!=typeof e&&s(e)&&p.push(e)}function*A(e){if(Array.isArray(e))for(const t in e)if(s(e[t]))yield[e,t];else for(let n of A(e[t]))yield n;else if(function(e){return"object"==typeof e&&null!==e&&"child"in e}(e))for(const t in e.child)if(s(e.child[t]))yield[e.child,t];else for(let n of A(e.child[t]))yield n}function w(e,t,n){if(Array.isArray(e))e.forEach((e,r)=>{let i;"string"!=typeof t&&"number"!=typeof t&&t&&t.DOMNode&&(i=Array.isArray(t)?t[r]:t.child[r]),w(e,i,n)});else if(!1!==e&&null!=e)if(e&&"string"!=typeof e&&"number"!=typeof e){if(!s(e)){let n;"string"!=typeof t&&"number"!=typeof t&&t&&t.DOMNode&&(e.DOMNode=t.DOMNode,n=t.child),D(e,n)}n.appendChild(e.DOMNode)}else n.appendChild(document.createTextNode(String(e)))}function D(e,t){if(!("isProcessed"in e)||!e.isProcessed){{let t=new DocumentFragment;if(void 0!==e.renderType){let n={},r={};for(let t in e.renderProps)[null,void 0,!1].includes(e.renderProps[t])||("function"!=typeof e.renderProps[t]?n[t]=e.renderProps[t]:r[t.slice(2)]=e.renderProps[t]);if(null!=e&&e.DOMNode&&e.DOMNode instanceof Element&&e.DOMNode.tagName.toLowerCase()===e.renderType){t=e.DOMNode;for(const r of e.DOMNode.attributes)r.name in n||t.removeAttribute(r.name);const r=t.getEventListeners();for(const e in r)r[e].forEach(n=>{t.removeEventListener(e,n.listener)});for(;t.firstChild;)t.removeChild(t.firstChild)}else t=document.createElement(e.renderType);for(let e in n)t.setAttribute(e,n[e]);for(let e in r)t.addEventListener(e,r[e]);null!=e&&e.ref&&(e.ref.current=t)}e.DOMNode=t}e.child.forEach((n,r)=>{w(n,null==t?void 0:t[r],e.DOMNode)})}}function O(t,n,r){if(r.isProcessed)return r;const i=null==n?void 0:n.child;if(r.type!==v){let i=!1;if(n&&(n.type===r.type?(i=!0,r.isDirty=n.isDirty):b(n)),r.isDirty=t||r.isDirty,r.isDirty){d(r.type.name,"is dirty");let l=r.props;const a=r.ref;var f;t&&(l=e({},r.props,{children:null!=(f=r.child)?f:[]})),i&&(r=n),r.props=l,r.ref=a,c=r;const u=r.type(e({},r.props),r.ref);void 0===u||!1===u||null===u?r.child=[]:Array.isArray(u)?r.child=u:"object"!=typeof u||s(u)&&u.type!==r.type?r.child=[u]:(r.renderType=u.renderType,r.renderProps=u.renderProps,r.child=u.child),d("Result:",r.type.name,o(r))}else d(r.type.name,"is clean"),i&&(r=n)}return function(e,t,n,r){for(const r in n)if("number"!=typeof n[r]&&"string"!=typeof n[r]){if(s(n[r])&&e||Array.isArray(n[r])||!s(n[r])){const o=A(null==t?void 0:t[r]),s=A(n[r]);for(const t of s){var i;const n=o.next().value;t[0][t[1]]=O(e,null==n||null==(i=n[0])?void 0:i[n[1]],t[0][t[1]])}for(const e of o)b(e[0][e[1]])}s(n[r])?n[r]=O(e,s(null==t?void 0:t[r])?t[r]:void 0,n[r]):s(null==t?void 0:t[r])&&b(null==t?void 0:t[r])}else(null==t?void 0:t[r])!==n[r]&&s(null==t?void 0:t[r])&&b(null==t?void 0:t[r])}("isDirty"in r&&r.isDirty,i,r.child),d("DONE: ",r.type.name,o(r)),D(r,i),r.isProcessed=!0,r}function E(e){"object"==typeof e&&e&&(Array.isArray(e)?e.forEach(e=>E(e)):(s(e)&&(e.stateIndex=0,e.effectIndex=0,e.memoIndex=0,e.isDirty=!1,e.isProcessed=!1),e.child.forEach(e=>{"object"==typeof e&&E(e)})))}function M(e,t=!1){if("string"!=typeof e&&"number"!=typeof e&&e&&(e.child.forEach(e=>{Array.isArray(e)?e.forEach(e=>M(e,t)):M(e,t)}),s(e)))for(let i=0;i<e.effects.length;i++){var n,r;e.effects[i].run&&e.effects[i].isLayout===t&&(null==(n=(r=e.effects[i]).cleanup)||n.call(r),e.effects[i].cleanup=e.effects[i].callback(),e.effects[i].run=!1)}}function j(e){if("string"!=typeof e&&"number"!=typeof e&&e&&(e.child.forEach(e=>{Array.isArray(e)?e.forEach(e=>j(e)):j(e)}),s(e)))for(let r=0;r<e.effects.length;r++){var t,n;null==(t=(n=e.effects[r]).cleanup)||t.call(n)}}function P(){for(d("----------------------------------------------------------------"),d("@@@@@@@ Batch updating..."),d=(...e)=>h("[State change]",...e);u.length;)u.pop()();d=h,d("@@@@@@@ Rendering...");const e=O(void 0,a,m(l));E(e),d("Result:",e),f.textContent="",f.appendChild(e.DOMNode),a=e;const t=new MessageChannel;function n(){for(d("@@@@@@ Running effects..."),d=(...e)=>h("[Effect]",...e),M(a),d=h,d("@@@@@@ Cleaning up unmounted components..."),d=(...e)=>h("[Effect cleanup]",...e);p.length;)j(p.pop());d=h}requestAnimationFrame(function(){d("@@@@@@ Running layout effects before repaint..."),d=(...e)=>h("[Layout effect]",...e),M(a,!0),d=h,u.length?(n(),clearTimeout(y.value),P()):(t.port1.onmessage=n,t.port2.postMessage(void 0),d("@@@@@@ Browser painted to the screen"))})}function S(e,t){t?f=t:(f=document.createDocumentFragment(),document.body.prepend(f)),l=e,P()}function N(e){var t;const n=c,r=n.stateIndex++;return null!=(t=n.state)[r]||(t[r]=e),[n.state[r],function(e){u.length||(y.value=setTimeout(P,0)),u.push(function(){"function"==typeof e&&(e=e(n.state[r])),n.state[r]!==e&&(console.log("Update from",n.state[r],"to",e,"in",n.type.name),n.state[r]=e,n.isDirty=!0)})}]}function x(t,n,r=!1){var i;const o=c,s=o.effectIndex++;let f=!1;n&&o.effects[s]&&n.length===(null==(i=o.effects[s].deps)?void 0:i.length)&&!n.some((e,t)=>{var n;return e!==(null==(n=o.effects[s].deps)?void 0:n[t])})||(f=!0),f&&(o.effects[s]=e({},o.effects[s],{deps:n,callback:t,run:f,isLayout:r}))}const C=(e,t)=>x(e,t,!0);function I(t,n){var r;const i=c,o=i.memoIndex++;let s=!1;return n&&i.memos[o]&&n.length===(null==(r=i.memos[o].deps)?void 0:r.length)&&!n.some((e,t)=>{var n;return e!==(null==(n=i.memos[o].deps)?void 0:n[t])})||(s=!0),s&&(i.memos[o]=e({},i.memos[o],{deps:n,factory:t,value:t()})),i.memos[o].value}function B(e,t){return I(()=>e,t)}function T(e){return I(()=>({current:e}),[])}function k(e,t){if(null===e)return!1;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;if(0===n.length)return!0;for(let r=0;r<n.length;r++)if("children"!==n[r]&&e[n[r]]!==t[n[r]])return!1;return k(e.children,t.children)}function V(e,t=k){const n=function(n,r){const i=T(null);return x(()=>{i.current=n},[n]),console.log("[Memo check]",t(i.current,n),i.current,n),t(i.current,n)?c:e(n,r)};return Object.defineProperty(n,"name",{value:e.name,writable:!1}),n}export{v as Fragment,L as fuse,V as memo,S as render,B as useCallback,x as useEffect,C as useLayoutEffect,I as useMemo,T as useRef,N as useState};
//# sourceMappingURL=refuse.modern.js.map
